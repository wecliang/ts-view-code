import{ae as x,k as c,au as N,q as a,bf as P,bH as K,b5 as V,a7 as G,ad as O,a6 as U,an as I,b4 as X,cq as Q,cr as W,bk as Y,bc as Z,bI as ee,bT as y,bU as te,bd as ae,y as B,bC as re,bx as ne,bS as se}from"./index.18d05f4c.js";import oe from"./index5.91f83f2b.js";import"./index7.61fb0f02.js";import"./vendor.0b417fb8.js";var ie=Object.defineProperty,w=Object.getOwnPropertySymbols,J=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable,D=(t,e,r)=>e in t?ie(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,R=(t,e)=>{for(var r in e||(e={}))J.call(e,r)&&D(t,r,e[r]);if(w)for(var r of w(e))$.call(e,r)&&D(t,r,e[r]);return t},ce=(t,e)=>{var r={};for(var n in t)J.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&w)for(var n of w(t))e.indexOf(n)<0&&$.call(t,n)&&(r[n]=t[n]);return r};function j(t,e,r){return e=le(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function le(t){var e=de(t,"string");return typeof e=="symbol"?e:String(e)}function de(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ue=window.React,pe=window.React.useMemo,me=window.React.useState;class fe{constructor(){j(this,"json",{type:"object"}),j(this,"setJson",(e={type:"object"})=>{this.json=e}),j(this,"data",[]),j(this,"setData",()=>{var e;this.data=((e=se(this.json,[]))==null?void 0:e.children)||[]})}}function he(t){var e=t,{onChange:r,readOnly:n,columnKeys:u,isExpression:C}=e,S=ce(e,["onChange","readOnly","columnKeys","isExpression"]);const[s]=me(()=>{const l=new fe;return l.setJson(S.value),l.setData(),l}),b=()=>{r&&r(R({},s.json))},f=pe(()=>{const l=[{title:"\u5FC5\u586B",dataIndex:"_parentStore",render:(d,o)=>{const i=o.schemaPath.slice(0,-2),p=y.get(s.json,i,{}).required||[];return a(ae,{checked:p.includes(o.key),disabled:n,onChange:T=>{const v=p.filter(_=>_!==o.key);T?y.set(s.json,[...i,"required"],[...v,o.key]):y.set(s.json,[...i,"required"],v),b()}})}},{title:"\u6807\u9898",dataIndex:"title",render:(d,o)=>a(B,{placeholder:"\u8BF7\u8F93\u5165",autoComplete:"off",defaultValue:o._store.title,readOnly:n,onChange:i=>{y.set(s.json,[...o.schemaPath,"title"],i)}})},{title:"\u5B57\u6BB5\u63CF\u8FF0",dataIndex:"description",render:(d,o)=>a(B,{placeholder:"\u8BF7\u8F93\u5165",autoComplete:"off",readOnly:n,defaultValue:o._store.description,onChange:i=>{y.set(s.json,[...o.schemaPath,"description"],i),b()}})},{title:"\u9ED8\u8BA4\u503C",dataIndex:"default",ellipsis:!0,render:(d,o)=>{let i="";const h=o._store.default;return h&&typeof h!="object"&&(i=String(h)),c("div",{className:"table-default",children:[a(I,{content:i,children:a("div",{className:"table-default-text",children:i})}),a("div",{children:C&&a(re,{onChange:p=>{console.log("ExpressionSelect",s.json),y.set(s.json,[...o.schemaPath,"default"],p.value)},children:a(O,{type:"text",size:"small",shape:"circle",icon:a(ne,{})})})})]})}}];return u?l.filter(d=>u.includes(d.dataIndex)):l},[]);return ee(()=>{const l=y.omit(S,["value","store"]);return a(ue.Fragment,{children:a(te,R({resizable:!0,scroll:{y:300},columns:[{title:"\u8DEF\u5F84",dataIndex:"path",width:120,ellipsis:!0},{title:"Type",dataIndex:"type"},...f],pagination:!1,data:s.data},l))})})}const ye="_components_10phm_1";var L={components:ye};const M=window.React.useEffect,ge=window.React.useRef,g=window.React.useState,be=x.Group,_e=({value:t,isDescription:e,notMode:r=!1,onChange:n})=>{const u=ge(),[C,S]=g("Body"),[s,b]=g("Text"),[f,l]=g("JSON"),[d,o]=g(),[i,h]=g(),[p,T]=g(),[v,_]=g([]);M(()=>{if(!u.current){u.current=!0;return}n&&(u.current={mode:s,type:f,data:d,schema:i,formData:v},n(u.current))},[s,f,d,i,v]);const E=JSON.stringify(t);M(()=>{if(typeof t=="object"&&E!==JSON.stringify(u.current)){const{mode:m,type:F,data:A,schema:q,formData:H}=t;b(m||"Text"),l(F||"JSON"),o(A),h(q),_(H||[]),u.current=null}},[E]);const k=c(N,{children:[a(N.Item,{onClick:()=>b("Text"),children:"Text"},"Text"),a(N.Item,{onClick:()=>b("Form"),children:"Form"},"Form")]}),z=s==="Text"&&f==="JSON";return c("div",{className:L.components,children:[c(P,{className:L.components,type:"card-gutter",activeTab:C,onChange:m=>{switch(m){case"Body":case"schema":try{const F=JSON.parse(d);h(K(F,i)),S(m)}catch{V.warning("\u8BF7\u5148\u8F93\u5165\u6B63\u786E\u7684JSON\u6570\u636E")}}},extra:r?void 0:a(G,{droplist:k,trigger:"click",position:"br",children:c(O,{type:"text",children:[s,a(U,{})]})}),children:[c(P.TabPane,{style:{padding:0},title:c("span",{children:["Body",a(I,{content:c("div",{children:["Learn more from the",a(X,{href:"https://datatracker.ietf.org/doc/html/rfc7230#section-3.3",target:"_blank",children:"HTTP specification"})]}),children:a(Q,{})})]}),children:[s==="Text"&&a(W,{value:d,onChange:o,ext:f.toLocaleLowerCase()}),s==="File"&&(p?a("div",{className:"arco-upload-trigger fadeIn-enter-done",children:c("div",{className:"arco-upload-trigger-drag",children:[c("p",{className:"arco-upload-trigger-drag-text",children:["Size\uFF1A",p.size,"\uFF0CType\uFF1A",p.type]}),a("p",{className:"arco-upload-trigger-drag-text",children:p.name}),a(O,{type:"text",long:!0,onClick:()=>T(void 0),children:"\u91CD\u65B0\u4E0A\u4F20"})]})}):a(Y,{limit:1,drag:!0,multiple:!0,action:"/",onChange:m=>{T(m[0].originFile)}})),s==="Form"&&a(oe,{style:{margin:"10px 0"},isDescription:e,value:v,supportType:["Text"],addText:"Add form parameter",onChange:_})]},"Body"),e&&z&&a(P.TabPane,{title:"\u6570\u636E\u7ED3\u6784",destroyOnHide:!0,style:{padding:0},children:a(he,{value:i,columnKeys:["default","description"],onChange:h})},"schema")]}),s==="Text"&&c(Z,{size:"mini",children:[c(be,{type:"button",size:"mini",name:"lang",value:f,onChange:l,children:[a(x,{value:"Text",children:"Text"}),a(x,{value:"JSON",children:"JSON"}),a(x,{value:"XML",children:"XML"}),a(x,{value:"HTML",children:"HTML"})]}),f==="JSON"&&a("span",{children:a(O,{size:"mini",type:"text",onClick:()=>{try{const m=JSON.parse(d);o(JSON.stringify(m,null,"	"))}catch{}},children:"Format body"})})]})]})};export{_e as default};
